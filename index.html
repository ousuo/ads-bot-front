<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #3390ec;
            --primary-dark: #2b7cd3;
            --success: #31b545;
            --warning: #f5a623;
            --danger: #e53935;
            --radius: 12px;
            --radius-sm: 8px;
            --shadow: 0 2px 8px rgba(0,0,0,0.08);
            --transition: all 0.2s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            line-height: 1.5;
            min-height: 100vh;
            padding-bottom: 100px;
        }
        
        /* Header */
        .header {
            background: var(--tg-theme-secondary-bg-color, #f4f4f5);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--tg-theme-hint-color, #e0e0e0);
        }
        
        .header h1 {
            font-size: 20px;
            font-weight: 600;
            text-align: center;
        }
        
        .header-subtitle {
            font-size: 13px;
            color: var(--tg-theme-hint-color, #999);
            text-align: center;
            margin-top: 4px;
        }
        
        /* Container */
        .container {
            padding: 16px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Sections */
        .section {
            background: var(--tg-theme-secondary-bg-color, #f4f4f5);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .section-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--tg-theme-hint-color, #999);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .section-title .icon {
            font-size: 16px;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group:last-child {
            margin-bottom: 0;
        }
        
        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--tg-theme-text-color, #000);
        }
        
        .label-hint {
            font-weight: 400;
            color: var(--tg-theme-hint-color, #999);
            font-size: 12px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            background: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            font-size: 16px;
            font-family: inherit;
            outline: none;
            transition: var(--transition);
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--tg-theme-button-color, var(--primary));
            box-shadow: 0 0 0 3px rgba(51, 144, 236, 0.1);
        }
        
        input::placeholder, textarea::placeholder {
            color: var(--tg-theme-hint-color, #999);
        }
        
        textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.6;
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23999' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 20px;
            padding-right: 44px;
            cursor: pointer;
        }
        
        /* Row Layout */
        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        /* Price Input */
        .price-input-wrapper {
            position: relative;
        }
        
        .price-input-wrapper input {
            padding-right: 50px;
        }
        
        .price-currency {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--tg-theme-hint-color, #999);
            font-weight: 500;
        }
        
        /* Checkbox */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 22px;
            height: 22px;
            border-radius: 6px;
            cursor: pointer;
            accent-color: var(--tg-theme-button-color, var(--primary));
        }
        
        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            flex: 1;
        }
        
        /* Character Counter */
        .char-counter {
            text-align: right;
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
            margin-top: 6px;
        }
        
        .char-counter.warning {
            color: var(--warning);
        }
        
        .char-counter.danger {
            color: var(--danger);
        }
        
        /* Tags/Chips */
        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .chip {
            padding: 8px 14px;
            border-radius: 20px;
            background: var(--tg-theme-bg-color, #fff);
            border: 2px solid transparent;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
        }
        
        .chip:active {
            transform: scale(0.96);
        }
        
        .chip.selected {
            background: var(--tg-theme-button-color, var(--primary));
            color: var(--tg-theme-button-text-color, #fff);
        }
        
        /* Info Box */
        .info-box {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px;
            background: rgba(51, 144, 236, 0.1);
            border-radius: var(--radius-sm);
            margin-top: 12px;
        }
        
        .info-box .icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .info-box p {
            font-size: 13px;
            color: var(--tg-theme-text-color, #000);
            opacity: 0.8;
        }
        
        /* Validation */
        .form-group.error input,
        .form-group.error textarea,
        .form-group.error select {
            border-color: var(--danger);
        }
        
        .error-message {
            color: var(--danger);
            font-size: 12px;
            margin-top: 6px;
            display: none;
        }
        
        .form-group.error .error-message {
            display: block;
        }
        
        /* Loading State */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        /* Progress Indicator */
        .progress-bar {
            height: 3px;
            background: var(--tg-theme-hint-color, #e0e0e0);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 12px;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--tg-theme-button-color, var(--primary));
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        
        /* Animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section {
            animation: fadeIn 0.3s ease;
        }
        
        /* Dark theme adjustments */
        @media (prefers-color-scheme: dark) {
            .info-box {
                background: rgba(51, 144, 236, 0.15);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìù –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h1>
        <p class="header-subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</p>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
    </div>
    
    <div class="container">
        <form id="adForm">
            <!-- –¢–∏–ø –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">üìã</span>
                    –û—Å–Ω–æ–≤–Ω–æ–µ
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="adType">–¢–∏–ø –æ–±—ä—è–≤–ª–µ–Ω–∏—è</label>
                        <select id="adType" required>
                            <option value="–ü—Ä–æ–¥–∞–º">üè∑ –ü—Ä–æ–¥–∞–º</option>
                            <option value="–ö—É–ø–ª—é">üõí –ö—É–ø–ª—é</option>
                            <option value="–£—Å–ª—É–≥–∞">üîß –£—Å–ª—É–≥–∞</option>
                            <option value="–í–∞–∫–∞–Ω—Å–∏—è">üíº –í–∞–∫–∞–Ω—Å–∏—è</option>
                            <option value="–ê—Ä–µ–Ω–¥–∞">üè† –ê—Ä–µ–Ω–¥–∞</option>
                            <option value="–û–±–º–µ–Ω">üîÑ –û–±–º–µ–Ω</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="category" required>
                            <option value="–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                            <option value="–û–¥–µ–∂–¥–∞">üëï –û–¥–µ–∂–¥–∞</option>
                            <option value="–ê–≤—Ç–æ">üöó –ê–≤—Ç–æ/–ú–æ—Ç–æ</option>
                            <option value="–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å">üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                            <option value="–†–∞–±–æ—Ç–∞">üíº –†–∞–±–æ—Ç–∞</option>
                            <option value="–£—Å–ª—É–≥–∏">üîß –£—Å–ª—É–≥–∏</option>
                            <option value="–î–æ–º">üè° –î–æ–º –∏ —Å–∞–¥</option>
                            <option value="–î–µ—Ç—Å–∫–æ–µ">üë∂ –î–µ—Ç—Å–∫–æ–µ</option>
                            <option value="–•–æ–±–±–∏">üé® –•–æ–±–±–∏</option>
                            <option value="–î—Ä—É–≥–æ–µ">üì¶ –î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">‚úèÔ∏è</span>
                    –û–ø–∏—Å–∞–Ω–∏–µ
                </div>
                
                <div class="form-group">
                    <label for="title">
                        –ó–∞–≥–æ–ª–æ–≤–æ–∫
                        <span class="label-hint">¬∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>
                    </label>
                    <input 
                        type="text" 
                        id="title" 
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: iPhone 14 Pro 256GB"
                        maxlength="100"
                        required
                    >
                    <div class="char-counter"><span id="titleCount">0</span>/100</div>
                    <div class="error-message">–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)</div>
                </div>
                
                <div class="form-group">
                    <label for="description">
                        –û–ø–∏—Å–∞–Ω–∏–µ
                        <span class="label-hint">¬∑ –ø–æ–¥—Ä–æ–±–Ω–µ–µ = –ª—É—á—à–µ</span>
                    </label>
                    <textarea 
                        id="description" 
                        placeholder="–û–ø–∏—à–∏—Ç–µ —Ç–æ–≤–∞—Ä: —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è, –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏..."
                        maxlength="1000"
                    ></textarea>
                    <div class="char-counter"><span id="descCount">0</span>/1000</div>
                </div>
            </div>
            
            <!-- –¶–µ–Ω–∞ -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">üí∞</span>
                    –¶–µ–Ω–∞
                </div>
                
                <div class="form-group">
                    <label for="price">–°—Ç–æ–∏–º–æ—Å—Ç—å</label>
                    <div class="price-input-wrapper">
                        <input 
                            type="number" 
                            id="price" 
                            placeholder="0"
                            min="0"
                            max="999999999"
                        >
                        <span class="price-currency">‚ÇΩ</span>
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="negotiable">
                    <label for="negotiable">–¶–µ–Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è / —Ç–æ—Ä–≥ —É–º–µ—Å—Ç–µ–Ω</label>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">üìû</span>
                    –ö–æ–Ω—Ç–∞–∫—Ç—ã
                </div>
                
                <div class="form-group">
                    <label for="contact">
                        –ö–∞–∫ —Å –≤–∞–º–∏ —Å–≤—è–∑–∞—Ç—å—Å—è
                        <span class="label-hint">¬∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>
                    </label>
                    <input 
                        type="text" 
                        id="contact" 
                        placeholder="@username, —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ email"
                        required
                    >
                    <div class="error-message">–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è —Å–≤—è–∑–∏</div>
                </div>
                
                <div class="form-group">
                    <label for="location">
                        –õ–æ–∫–∞—Ü–∏—è
                        <span class="label-hint">¬∑ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>
                    </label>
                    <input 
                        type="text" 
                        id="location" 
                        placeholder="–ì–æ—Ä–æ–¥, —Ä–∞–π–æ–Ω"
                    >
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="info-box">
                <span class="icon">‚ÑπÔ∏è</span>
                <p>
                    –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–æ—Ç–æ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é (1 ‚≠ê). 
                    –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–π–¥—ë—Ç –º–æ–¥–µ—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π.
                </p>
            </div>
        </form>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤ –∫–Ω–æ–ø–∫–∏
        tg.MainButton.setParams({
            text: '–ü–†–û–î–û–õ–ñ–ò–¢–¨ ‚Üí',
            color: tg.themeParams.button_color || '#3390ec',
            text_color: tg.themeParams.button_text_color || '#ffffff',
            is_active: true,
            is_visible: true
        });
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã
        const form = document.getElementById('adForm');
        const titleInput = document.getElementById('title');
        const descInput = document.getElementById('description');
        const priceInput = document.getElementById('price');
        const contactInput = document.getElementById('contact');
        const locationInput = document.getElementById('location');
        const adTypeSelect = document.getElementById('adType');
        const categorySelect = document.getElementById('category');
        const negotiableCheck = document.getElementById('negotiable');
        const progressFill = document.getElementById('progressFill');
        
        // –°—á—ë—Ç—á–∏–∫–∏ —Å–∏–º–≤–æ–ª–æ–≤
        const titleCount = document.getElementById('titleCount');
        const descCount = document.getElementById('descCount');
        
        // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞
        if (tg.initDataUnsafe?.user?.username) {
            contactInput.value = '@' + tg.initDataUnsafe.user.username;
            updateProgress();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤
        titleInput.addEventListener('input', () => {
            titleCount.textContent = titleInput.value.length;
            updateCharCounterStyle(titleCount, titleInput.value.length, 100);
            updateProgress();
            validateField(titleInput, titleInput.value.length >= 3);
        });
        
        descInput.addEventListener('input', () => {
            descCount.textContent = descInput.value.length;
            updateCharCounterStyle(descCount, descInput.value.length, 1000);
            updateProgress();
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞
        contactInput.addEventListener('input', () => {
            updateProgress();
            validateField(contactInput, contactInput.value.length >= 2);
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
        [priceInput, locationInput, adTypeSelect, categorySelect].forEach(el => {
            el.addEventListener('input', updateProgress);
            el.addEventListener('change', updateProgress);
        });
        
        function updateCharCounterStyle(counter, current, max) {
            const parent = counter.parentElement;
            parent.classList.remove('warning', 'danger');
            
            if (current >= max * 0.9) {
                parent.classList.add('danger');
            } else if (current >= max * 0.7) {
                parent.classList.add('warning');
            }
        }
        
        function validateField(input, isValid) {
            const formGroup = input.closest('.form-group');
            if (isValid) {
                formGroup.classList.remove('error');
            } else if (input.value.length > 0) {
                formGroup.classList.add('error');
            }
        }
        
        function updateProgress() {
            let filled = 0;
            const total = 4; // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: —Ç–∏–ø, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ–Ω—Ç–∞–∫—Ç
            
            if (adTypeSelect.value) filled++;
            if (categorySelect.value) filled++;
            if (titleInput.value.length >= 3) filled++;
            if (contactInput.value.length >= 2) filled++;
            
            const percentage = (filled / total) * 100;
            progressFill.style.width = percentage + '%';
        }
        
        function validateForm() {
            let isValid = true;
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫
            if (titleInput.value.length < 3) {
                titleInput.closest('.form-group').classList.add('error');
                titleInput.classList.add('shake');
                setTimeout(() => titleInput.classList.remove('shake'), 300);
                isValid = false;
            }
            
            // –ö–æ–Ω—Ç–∞–∫—Ç
            if (contactInput.value.length < 2) {
                contactInput.closest('.form-group').classList.add('error');
                contactInput.classList.add('shake');
                setTimeout(() => contactInput.classList.remove('shake'), 300);
                isValid = false;
            }
            
            return isValid;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
        tg.MainButton.onClick(() => {
            // Haptic feedback
            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }
            
            if (!validateForm()) {
                if (tg.HapticFeedback) {
                    tg.HapticFeedback.notificationOccurred('error');
                }
                tg.showPopup({
                    title: '–û—à–∏–±–∫–∞',
                    message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è',
                    buttons: [{type: 'ok'}]
                });
                return;
            }
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ü–µ–Ω—É
            let priceText = priceInput.value || '0';
            if (negotiableCheck.checked) {
                priceText = priceInput.value ? `${priceInput.value} (—Ç–æ—Ä–≥)` : '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è';
            }
            
            const data = {
                adType: adTypeSelect.value,
                category: categorySelect.value,
                title: titleInput.value.trim(),
                price: priceText,
                contact: contactInput.value.trim(),
                description: descInput.value.trim(),
                location: locationInput.value.trim() || null
            };
            
            // –£—Å–ø–µ—à–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è
            if (tg.HapticFeedback) {
                tg.HapticFeedback.notificationOccurred('success');
            }
            
            tg.sendData(JSON.stringify(data));
        });
        
        // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        updateProgress();
    </script>
</body>
</html>